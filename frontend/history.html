<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>History - AI Ticket System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="history-page">

  <!-- PROTECT PAGE -->
  <script>
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      window.location.href = "login.html";
    }
  </script>

  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">
        <div class="logo-icon">AI</div>
        AI Ticket
      </a>

      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="create.html">Create Ticket</a></li>
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="history.html" class="active">History</a></li>
        <li><a href="help.html">Help Center</a></li>
        <li id="authLink"></li>
      </ul>
    </div>
  </nav>

  <main class="history-shell">
    <section class="history-hero">
      <p class="history-kicker">Ticket Timeline</p>
      <h1>Track your support activity from open to resolved.</h1>
      <p>Each entry shows category, priority, and status so you can review request flow over time.</p>
    </section>

    <section class="history-wrap">
      <div class="history-header">
        <h2>Ticket Activity</h2>
        <p class="history-sub">Chronological record of your support requests</p>
      </div>

      <div class="table-container">
        <table class="history-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Title</th>
              <th>Category</th>
              <th>Priority</th>
              <th>Confidence</th>
              <th>Status</th>
              <th>Created</th>
            </tr>
          </thead>
          <tbody id="ticketsBody">
            <tr>
              <td colspan="7" style="text-align:center;padding:28px;">Loading activity...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <ul class="footer-links">
        <li><a href="#" class="about-link">About</a></li>
        <li><a href="#" class="privacy-policy-link">Privacy Policy</a></li>
        <li><a href="help.html#contact">Contact</a></li>
      </ul>
      <div class="footer-copy">
        © 2026 AI Ticket System. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- Dynamic Login/Logout -->
  <script>
    const authLink = document.getElementById("authLink");
    if (user) {
      const rawLabel = String(user.name || user.email || "Account");
      const label = rawLabel.split(" ")[0];
      const initial = label.charAt(0).toUpperCase();
      authLink.innerHTML = `
        <div class="auth-menu">
          <button type="button" class="auth-menu-toggle">
            <span class="auth-avatar">${initial}</span>
            <span class="auth-label">${label}</span>
            <span class="auth-caret">▾</span>
          </button>
          <div class="auth-dropdown">
            <a href="profile.html" class="auth-menu-item">Profile</a>
            <a href="settings.html" class="auth-menu-item">Settings</a>
            <button type="button" class="auth-menu-item auth-logout-btn">Logout</button>
          </div>
        </div>`;
    } else {
      authLink.innerHTML = `<a href="login.html">Login</a>`;
    }
  </script>

  <script src="js/runtime-config.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
